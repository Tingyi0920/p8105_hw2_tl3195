p8105_hw2_tl3195
================
Tingyi Li
2023-10-04

load libraries

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

# Problem 1

Clean the data in `pols-month.csv`:

Use `separate()` to break up the variable `mon` into integer variables
`year`, `month`, and `day`. Replace month number with month name. Create
a `president` variable taking values `gop` and `dem`, and remove
`prez_dem` and `prez_gop`; and remove the day variable.

``` r
pols_month = read.csv("./fivethirtyeight_datasets/pols-month.csv") |>
  janitor::clean_names()|>
  separate(mon,into=c("year","month","day"))|>
  mutate(month = month.name[as.numeric(month)],
         president=
           case_match(prez_gop, 0~"democratic", 1~"republican", 2~"republican")
        )|>
  select(-prez_dem,-prez_gop,-day)
```

Clean snp.csv with a similar process:

arrange according to year and month, and organize so that `year` and
`month` are the leading columns.

``` r
snp = read_csv("./fivethirtyeight_datasets/snp.csv",
    col_types = cols(date = col_date(format = "%m/%d/%y"))) |>
  separate(date, into = c("year", "month", "day"), convert = TRUE) |>
  mutate(month = month.name[as.numeric(month)],
         year = if_else(year > 2023, year - 100, year)) |> 
  select(year, month, close) 
```

Tidy the unemployment data so that it can be merged with the previous
datasets.

Switching from “wide” to “long” format. Ensuring that key variables have
the same name. Ensuring that key variables have the same values.

``` r
unemployment = read_csv("./fivethirtyeight_datasets/unemployment.csv") |>
  rename(year = Year) |>
  pivot_longer(
    Jan:Dec, 
    names_to = "month",
    values_to = "unemployment"
  ) |> 
  mutate(month=month.name[match(month,month.abb)])|>
  mutate(year=as.character(year))
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Join the datasets by merging `snp` into `pols`, and merging
`unemployment` into the result.

``` r
pols_month$year <- as.numeric(pols_month$year)
snp$year <- as.numeric(snp$year)
unemployment$year <- as.numeric(unemployment$year)

data=pols_month |>
  left_join(snp, by=c("year", "month")) |>
  left_join(unemployment, by=c("year", "month"))

str(data)
```

    ## 'data.frame':    822 obs. of  11 variables:
    ##  $ year        : num  1947 1947 1947 1947 1947 ...
    ##  $ month       : chr  "January" "February" "March" "April" ...
    ##  $ gov_gop     : int  23 23 23 23 23 23 23 23 23 23 ...
    ##  $ sen_gop     : int  51 51 51 51 51 51 51 51 51 51 ...
    ##  $ rep_gop     : int  253 253 253 253 253 253 253 253 253 253 ...
    ##  $ gov_dem     : int  23 23 23 23 23 23 23 23 23 23 ...
    ##  $ sen_dem     : int  45 45 45 45 45 45 45 45 45 45 ...
    ##  $ rep_dem     : int  198 198 198 198 198 198 198 198 198 198 ...
    ##  $ president   : chr  "democratic" "democratic" "democratic" "democratic" ...
    ##  $ close       : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ unemployment: num  NA NA NA NA NA NA NA NA NA NA ...
